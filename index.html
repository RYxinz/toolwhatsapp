<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>WEB TOOL VVIP</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{
  margin:0;font-family:Arial;
  background:radial-gradient(circle at top,#1a0026,#0b0014);
  color:#fff;overflow:hidden
}
canvas{position:fixed;inset:0;z-index:-1}
.box{
  max-width:420px;margin:70px auto;padding:18px;
  background:#120018e6;border-radius:14px;
  box-shadow:0 0 30px #ff2f92
}
h1,h2{text-align:center;color:#ff86c8;margin:.3em 0}
input,select,button{
  width:100%;padding:12px;margin:6px 0;
  border:0;border-radius:10px
}
input,select{background:#1e002b;color:#fff}
button{background:#ff2f92;color:#fff;font-weight:bold}
button:disabled{opacity:.45}
.hidden{display:none}
.small{text-align:center;font-size:12px;color:#ffb3df}
hr{border:0;border-top:1px solid #ff4fa0;margin:10px 0}
</style>
</head>
<body>

<canvas id="fx"></canvas>

<!-- LOGIN -->
<div class="box" id="loginBox">
  <h1>WEB TOOL VVIP</h1>
  <input id="u" placeholder="Username">
  <input id="p" type="password" placeholder="Password">
  <button onclick="login()">LOGIN</button>
  <div id="info" class="small"></div>
</div>

<!-- DASH -->
<div class="box hidden" id="dash">
  <h2 id="roleTxt"></h2>
  <div id="clock" class="small"></div>
  <hr>
  <button id="banBtn" onclick="openBan()">BAN / UNBAN</button>
  <button onclick="buyPremium()">BELI PREMIUM</button>
  <button id="ownerBtn" onclick="openOwner()">PANEL OWNER</button>
  <button onclick="logout()">LOGOUT</button>
</div>

<!-- BAN -->
<div class="box hidden" id="banBox">
  <h2>BAN / UNBAN</h2>
  <select id="type">
    <option value="ban">BAN</option>
    <option value="unban">UNBAN</option>
  </select>
  <input id="target" placeholder="Nomor target 62xxx">
  <button onclick="sendReport()">KIRIM</button>
  <button onclick="back()">KEMBALI</button>
</div>

<!-- OWNER -->
<div class="box hidden" id="ownerBox">
  <h2>PANEL OWNER</h2>
  <input id="newUser" placeholder="Username Premium">
  <input id="newPass" placeholder="Password">
  <input id="days" type="number" placeholder="Masa aktif (hari)">
  <button onclick="addPremium()">TAMBAH PREMIUM</button>
  <button onclick="resetDevice()">RESET DEVICE USER</button>
  <button onclick="back()">KEMBALI</button>
  <div id="ownerInfo" class="small"></div>
</div>

<script>
/* ========= DEVICE ID ========= */
let deviceId = localStorage.getItem("deviceId");
if(!deviceId){
  deviceId = "dev-" + Math.random().toString(36).slice(2);
  localStorage.setItem("deviceId", deviceId);
}

/* ========= USERS INIT ========= */
const BASE_USERS = {
  brama:{p:"brama123", r:"OWNER"},
  admin:{p:"admin123", r:"ADMIN"}
};

let users;
try{
  users = JSON.parse(localStorage.getItem("users"));
  if(!users || typeof users!=="object") throw 0;
}catch{ users = {}; }

for(const k in BASE_USERS){
  if(!users[k]) users[k] = BASE_USERS[k];
}
localStorage.setItem("users", JSON.stringify(users));

let current = null;

/* ========= LOGIN (1 KALI LOGIN) ========= */
function login(){
  const u = document.getElementById("u").value.trim();
  const p = document.getElementById("p").value.trim();
  const info = document.getElementById("info");

  if(!users[u]){ info.innerText="Username tidak ditemukan"; return; }
  if(users[u].p !== p){ info.innerText="Password salah"; return; }

  // cek expired premium
  if(users[u].r==="PREMIUM" && users[u].exp && Date.now()>users[u].exp){
    users[u].r="USER"; delete users[u].exp;
  }

  // device lock
  if(users[u].device && users[u].device !== deviceId){
    info.innerText="Akun terkunci di device lain";
    return;
  }
  users[u].device = deviceId;
  localStorage.setItem("users", JSON.stringify(users));

  current = u;
  sessionStorage.setItem("login", u); // 1x login
  openDash();
}

/* ========= AUTO LOGIN ========= */
const saved = sessionStorage.getItem("login");
if(saved && users[saved]){
  current = saved;
  openDash();
}

/* ========= DASH ========= */
function openDash(){
  document.getElementById("loginBox").classList.add("hidden");
  document.getElementById("dash").classList.remove("hidden");

  const r = users[current].r;
  document.getElementById("roleTxt").innerText = r+" DASHBOARD";
  document.getElementById("banBtn").disabled = !(r==="PREMIUM"||r==="OWNER");
  document.getElementById("ownerBtn").style.display = r==="OWNER"?"block":"none";
}

/* ========= CLOCK ========= */
setInterval(()=>{
  document.getElementById("clock").innerText =
    new Date().toLocaleString("id-ID");
},1000);

/* ========= BAN ========= */
function openBan(){
  dash.classList.add("hidden");
  banBox.classList.remove("hidden");
}
function sendReport(){
  alert("Report disiapkan (simulasi)");
}

/* ========= PREMIUM ========= */
function buyPremium(){
  location.href="https://wa.me/6283152406327?text="+
  encodeURIComponent("Halo, saya ingin beli PREMIUM WEB TOOL VVIP");
}

/* ========= OWNER ========= */
function openOwner(){
  dash.classList.add("hidden");
  ownerBox.classList.remove("hidden");
}
function addPremium(){
  const u = newUser.value.trim();
  if(!u) return;
  users[u]={
    p:newPass.value||"123456",
    r:"PREMIUM",
    exp:Date.now()+Number(days.value||0)*86400000
  };
  localStorage.setItem("users", JSON.stringify(users));
  ownerInfo.innerText="Premium ditambahkan";
}
function resetDevice(){
  const u=newUser.value.trim();
  if(users[u]){
    delete users[u].device;
    localStorage.setItem("users", JSON.stringify(users));
    ownerInfo.innerText="Device direset";
  }
}

/* ========= LOGOUT (WAJIB) ========= */
function logout(){
  sessionStorage.clear();
  location.reload();
}
function back(){
  banBox.classList.add("hidden");
  ownerBox.classList.add("hidden");
  dash.classList.remove("hidden");
}

/* ========= PARTICLES ========= */
const c=document.getElementById("fx"),ctx=c.getContext("2d");
function resize(){c.width=innerWidth;c.height=innerHeight}
addEventListener("resize",resize);resize();
const pts=[...Array(80)].map(()=>({x:Math.random()*c.width,y:Math.random()*c.height,s:Math.random()*2+0.5}));
(function anim(){
  ctx.clearRect(0,0,c.width,c.height);
  pts.forEach(p=>{
    p.y+=0.5;if(p.y>c.height)p.y=0;
    ctx.fillStyle="#ff4fa0";ctx.fillRect(p.x,p.y,p.s,p.s);
  });
  requestAnimationFrame(anim);
})();
</script>

</body>
  </html>
